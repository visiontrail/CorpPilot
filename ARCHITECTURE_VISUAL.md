# ğŸ›ï¸ CorpPilot æ¶æ„å¯è§†åŒ–

## ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å‰ç«¯ (React)                              â”‚
â”‚                     Dashboard / Upload                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ HTTP/JSON
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FastAPI åç«¯ (main.py)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ /health     â”‚ /api/analyze â”‚ /api/export  â”‚ /api/previewâ”‚   â”‚
â”‚  â”‚ å¥åº·æ£€æŸ¥     â”‚  JSONåˆ†æ     â”‚  Excelå¯¼å‡º   â”‚  æ•°æ®é¢„è§ˆ    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚               â”‚               â”‚
          â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DataLoader   â”‚  â”‚TravelAnalyzerâ”‚  â”‚ExcelExporter â”‚
â”‚ æ•°æ®åŠ è½½å™¨    â”‚  â”‚  åˆ†æå¼•æ“     â”‚  â”‚  å¯¼å‡ºæœåŠ¡     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                 â”‚                  â”‚
       â–¼                 â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Pandas / OpenPyXL                    â”‚
â”‚            æ•°æ®å¤„ç†å’ŒExcelæ“ä½œ                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Excel æ•°æ®æº (.xlsx)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚çŠ¶æ€æ˜ç»†  â”‚  æœºç¥¨   â”‚  é…’åº—   â”‚ ç«è½¦ç¥¨  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ¨¡å—äº¤äº’æµç¨‹

### æµç¨‹ 1: æ•°æ®åˆ†æ (`/api/analyze`)

```
å®¢æˆ·ç«¯                FastAPI              DataLoader           TravelAnalyzer
  â”‚                     â”‚                      â”‚                      â”‚
  â”‚  POST /api/analyze  â”‚                      â”‚                      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                      â”‚                      â”‚
  â”‚  (ä¸Šä¼  Excel)        â”‚                      â”‚                      â”‚
  â”‚                     â”‚                      â”‚                      â”‚
  â”‚                     â”‚  load_all_sheets()   â”‚                      â”‚
  â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                      â”‚
  â”‚                     â”‚                      â”‚                      â”‚
  â”‚                     â”‚  è¿”å› 4 ä¸ª DataFrame â”‚                      â”‚
  â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚
  â”‚                     â”‚                      â”‚                      â”‚
  â”‚                     â”‚  generate_dashboard_data()                 â”‚
  â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                     â”‚                      â”‚                      â”‚
  â”‚                     â”‚          åˆ†ææ•°æ® (Pandas æ“ä½œ)             â”‚
  â”‚                     â”‚          - é¡¹ç›®æˆæœ¬å½’é›†                     â”‚
  â”‚                     â”‚          - å¼‚å¸¸æ£€æµ‹                         â”‚
  â”‚                     â”‚          - é¢„è®¢è¡Œä¸ºåˆ†æ                     â”‚
  â”‚                     â”‚          - éƒ¨é—¨æŒ‡æ ‡è®¡ç®—                     â”‚
  â”‚                     â”‚                      â”‚                      â”‚
  â”‚                     â”‚          è¿”å› JSON æ•°æ®                     â”‚
  â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                     â”‚                      â”‚                      â”‚
  â”‚    è¿”å› JSON        â”‚                      â”‚                      â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚                      â”‚
  â”‚                     â”‚                      â”‚                      â”‚
```

### æµç¨‹ 2: Excel å¯¼å‡º (`/api/export`)

```
å®¢æˆ·ç«¯                FastAPI              DataLoader     TravelAnalyzer    ExcelExporter
  â”‚                     â”‚                      â”‚                â”‚                â”‚
  â”‚  POST /api/export   â”‚                      â”‚                â”‚                â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                      â”‚                â”‚                â”‚
  â”‚  (ä¸Šä¼  Excel)        â”‚                      â”‚                â”‚                â”‚
  â”‚                     â”‚                      â”‚                â”‚                â”‚
  â”‚                     â”‚  load_all_sheets()   â”‚                â”‚                â”‚
  â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚                â”‚
  â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚                â”‚
  â”‚                     â”‚                      â”‚                â”‚                â”‚
  â”‚                     â”‚  generate_dashboard_data()            â”‚                â”‚
  â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
  â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚
  â”‚                     â”‚                      â”‚                â”‚                â”‚
  â”‚                     â”‚  export_with_analysis()                              â”‚
  â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                     â”‚                      â”‚                â”‚                â”‚
  â”‚                     â”‚            load_workbook() (openpyxl)                â”‚
  â”‚                     â”‚            add_dashboard_sheet()                     â”‚
  â”‚                     â”‚            add_anomaly_sheet()                       â”‚
  â”‚                     â”‚            save_to_bytes()                           â”‚
  â”‚                     â”‚                      â”‚                â”‚                â”‚
  â”‚                     â”‚          è¿”å› BytesIO                                â”‚
  â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                     â”‚                      â”‚                â”‚                â”‚
  â”‚  è¿”å› Excel æ–‡ä»¶    â”‚                      â”‚                â”‚                â”‚
  â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚                â”‚                â”‚
  â”‚                     â”‚                      â”‚                â”‚                â”‚
```

---

## æ•°æ®æµè½¬å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Excel æ–‡ä»¶  â”‚
â”‚  (4 Sheets)  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          DataLoader æ•°æ®åŠ è½½                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  1. è¯»å– Sheet: çŠ¶æ€æ˜ç»†, æœºç¥¨, é…’åº—,  â”‚  â”‚
â”‚  â”‚     ç«è½¦ç¥¨                              â”‚  â”‚
â”‚  â”‚  2. æ¸…æ´—æ•°æ®:                           â”‚  â”‚
â”‚  â”‚     - é‡‘é¢: å»é™¤ Â¥, è½¬ float           â”‚  â”‚
â”‚  â”‚     - æ—¥æœŸ: ç»Ÿä¸€ä¸º datetime            â”‚  â”‚
â”‚  â”‚     - é¡¹ç›®: æå–é¡¹ç›®ä»£ç                â”‚  â”‚
â”‚  â”‚  3. å¡«å……ç¼ºå¤±å€¼                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        4 ä¸ª DataFrame (Pandas)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ è€ƒå‹¤æ•°æ®  â”‚ æœºç¥¨æ•°æ® â”‚ é…’åº—æ•°æ® â”‚ç«è½¦ç¥¨æ•°æ®â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      TravelAnalyzer æ ¸å¿ƒåˆ†æ                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ç®—æ³• 1: é¡¹ç›®æˆæœ¬å½’é›†                   â”‚  â”‚
â”‚  â”‚    - æŒ‰é¡¹ç›®ä»£ç åˆ†ç»„                     â”‚  â”‚
â”‚  â”‚    - èšåˆæœºç¥¨+é…’åº—+ç«è½¦ç¥¨æˆæœ¬           â”‚  â”‚
â”‚  â”‚    - Top 10 æ’åº                       â”‚  â”‚
â”‚  â”‚                                        â”‚  â”‚
â”‚  â”‚  ç®—æ³• 2: äº¤å‰éªŒè¯å¼‚å¸¸æ£€æµ‹               â”‚  â”‚
â”‚  â”‚    - Conflict: ä¸Šç­ä½†æœ‰å·®æ—…æ¶ˆè´¹        â”‚  â”‚
â”‚  â”‚    - NoExpense: å‡ºå·®ä½†æ— å·®æ—…è®°å½•       â”‚  â”‚
â”‚  â”‚                                        â”‚  â”‚
â”‚  â”‚  ç®—æ³• 3: é¢„è®¢è¡Œä¸ºåˆ†æ                   â”‚  â”‚
â”‚  â”‚    - ç´§æ€¥é¢„è®¢æ¯”ä¾‹ (<=2å¤©)              â”‚  â”‚
â”‚  â”‚    - å¹³å‡æå‰å¤©æ•°                       â”‚  â”‚
â”‚  â”‚                                        â”‚  â”‚
â”‚  â”‚  ç®—æ³• 4: éƒ¨é—¨æŒ‡æ ‡è®¡ç®—                   â”‚  â”‚
â”‚  â”‚    - æ€»æˆæœ¬ã€å·¥æ—¶ã€äººæ•°                â”‚  â”‚
â”‚  â”‚    - é¥±å’Œåº¦è®¡ç®—                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â–¼                 â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JSON æ•°æ®   â”‚   â”‚Excelå¯¼å‡ºæœåŠ¡â”‚    â”‚ å‰ç«¯Dashboard â”‚
â”‚  /api/analyzeâ”‚   â”‚ /api/export â”‚    â”‚   å¯è§†åŒ–      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ æ–° Excel æ–‡ä»¶â”‚
                  â”‚  + åˆ†æç»“æœ  â”‚
                  â”‚  (2ä¸ªSheet) â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ ¸å¿ƒç®—æ³•æµç¨‹

### ç®—æ³• 1: é¡¹ç›®æˆæœ¬å½’é›†

```
è¾“å…¥: travel_df (åˆå¹¶åçš„å·®æ—…æ•°æ®)
â”‚
â”œâ”€ æå–å”¯ä¸€é¡¹ç›®ä»£ç 
â”‚  FOR EACH é¡¹ç›®ä»£ç :
â”‚    â”‚
â”‚    â”œâ”€ ç­›é€‰è¯¥é¡¹ç›®çš„æ‰€æœ‰è®°å½•
â”‚    â”‚
â”‚    â”œâ”€ è®¡ç®—:
â”‚    â”‚  - æ€»æˆæœ¬ = SUM(æˆä¿¡é‡‘é¢)
â”‚    â”‚  - æœºç¥¨æˆæœ¬ = SUM(æˆä¿¡é‡‘é¢ WHERE å·®æ—…ç±»å‹='æœºç¥¨')
â”‚    â”‚  - é…’åº—æˆæœ¬ = SUM(æˆä¿¡é‡‘é¢ WHERE å·®æ—…ç±»å‹='é…’åº—')
â”‚    â”‚  - ç«è½¦ç¥¨æˆæœ¬ = SUM(æˆä¿¡é‡‘é¢ WHERE å·®æ—…ç±»å‹='ç«è½¦ç¥¨')
â”‚    â”‚  - è®¢å•æ•°é‡ = COUNT(*)
â”‚    â”‚
â”‚    â””â”€ å­˜å‚¨åˆ°ç»“æœåˆ—è¡¨
â”‚
â”œâ”€ æŒ‰æ€»æˆæœ¬é™åºæ’åº
â”‚
â””â”€ è¾“å‡º: DataFrame (é¡¹ç›®ä»£ç , æ€»æˆæœ¬, å„é¡¹æˆæœ¬, è®¢å•æ•°)
```

### ç®—æ³• 2: äº¤å‰éªŒè¯ - Conflict æ£€æµ‹

```
è¾“å…¥: attendance_df, travel_df
â”‚
â”œâ”€ ç­›é€‰è€ƒå‹¤çŠ¶æ€ä¸º "ä¸Šç­" çš„è®°å½•
â”‚  FOR EACH ä¸Šç­è®°å½•:
â”‚    â”‚
â”‚    â”œâ”€ è·å–: æ—¥æœŸ, å§“å
â”‚    â”‚
â”‚    â”œâ”€ æŸ¥è¯¢: travel_df ä¸­
â”‚    â”‚        WHERE æ¶ˆè´¹æ—¥æœŸ = è¯¥æ—¥æœŸ
â”‚    â”‚        AND å·®æ—…äººå‘˜å§“å = è¯¥å§“å
â”‚    â”‚
â”‚    â”œâ”€ IF å­˜åœ¨åŒ¹é…è®°å½•:
â”‚    â”‚  â”‚
â”‚    â”‚  â””â”€ æ ‡è®°ä¸º Conflict å¼‚å¸¸
â”‚    â”‚     è®°å½•: å§“å, æ—¥æœŸ, è€ƒå‹¤çŠ¶æ€, å·®æ—…ç±»å‹,
â”‚    â”‚           å·®æ—…é‡‘é¢, éƒ¨é—¨, æè¿°
â”‚    â”‚
â”‚    â””â”€ ç»§ç»­ä¸‹ä¸€æ¡
â”‚
â””â”€ è¾“å‡º: å¼‚å¸¸åˆ—è¡¨
```

### ç®—æ³• 3: éƒ¨é—¨é¥±å’Œåº¦è®¡ç®—

```
è¾“å…¥: attendance_df
â”‚
â”œâ”€ æŒ‰ä¸€çº§éƒ¨é—¨åˆ†ç»„
â”‚  FOR EACH éƒ¨é—¨:
â”‚    â”‚
â”‚    â”œâ”€ è®¡ç®—:
â”‚    â”‚  - éƒ¨é—¨æ€»å·¥æ—¶ = SUM(å·¥æ—¶)
â”‚    â”‚  - éƒ¨é—¨äººæ•° = COUNT(DISTINCT å§“å)
â”‚    â”‚  - æ ‡å‡†å·¥æ—¶ = 176 (8h/å¤© Ã— 22å¤©/æœˆ)
â”‚    â”‚
â”‚    â”œâ”€ è®¡ç®—é¥±å’Œåº¦:
â”‚    â”‚  é¥±å’Œåº¦ = (éƒ¨é—¨æ€»å·¥æ—¶ / (éƒ¨é—¨äººæ•° Ã— æ ‡å‡†å·¥æ—¶)) Ã— 100%
â”‚    â”‚
â”‚    â””â”€ å­˜å‚¨åˆ°ç»“æœ
â”‚
â””â”€ è¾“å‡º: DataFrame (éƒ¨é—¨, æ€»æˆæœ¬, æ€»å·¥æ—¶, äººæ•°, é¥±å’Œåº¦)
```

---

## æŠ€æœ¯æ ˆæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              åº”ç”¨å±‚ (Application Layer)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  FastAPI Web Framework                   â”‚  â”‚
â”‚  â”‚  - è·¯ç”±ç®¡ç† (main.py)                    â”‚  â”‚
â”‚  â”‚  - è¯·æ±‚å¤„ç†                              â”‚  â”‚
â”‚  â”‚  - å“åº”åºåˆ—åŒ–                            â”‚  â”‚
â”‚  â”‚  - CORS ä¸­é—´ä»¶                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic Layer)      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ DataLoader   â”‚TravelAnalyzerâ”‚ExcelExporterâ”‚  â”‚
â”‚  â”‚ æ•°æ®åŠ è½½      â”‚  æ ¸å¿ƒåˆ†æ     â”‚  å¯¼å‡ºæœåŠ¡    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æ•°æ®å¤„ç†å±‚ (Data Processing Layer)      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Pandas                                  â”‚  â”‚
â”‚  â”‚  - DataFrame æ“ä½œ                        â”‚  â”‚
â”‚  â”‚  - æ•°æ®æ¸…æ´—                              â”‚  â”‚
â”‚  â”‚  - èšåˆè®¡ç®—                              â”‚  â”‚
â”‚  â”‚  - ç»Ÿè®¡åˆ†æ                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  OpenPyXL                                â”‚  â”‚
â”‚  â”‚  - Excel è¯»å†™                            â”‚  â”‚
â”‚  â”‚  - æ ·å¼ç®¡ç†                              â”‚  â”‚
â”‚  â”‚  - Sheet æ“ä½œ                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ•°æ®å­˜å‚¨å±‚ (Data Storage Layer)      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Excel æ–‡ä»¶ (.xlsx)                      â”‚  â”‚
â”‚  â”‚  - çŠ¶æ€æ˜ç»† (è€ƒå‹¤æ•°æ®)                   â”‚  â”‚
â”‚  â”‚  - æœºç¥¨æ•°æ®                              â”‚  â”‚
â”‚  â”‚  - é…’åº—æ•°æ®                              â”‚  â”‚
â”‚  â”‚  - ç«è½¦ç¥¨æ•°æ®                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## éƒ¨ç½²æ¶æ„ï¼ˆç”Ÿäº§ç¯å¢ƒå»ºè®®ï¼‰

```
                    Internet
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  Nginx (åå‘ä»£ç†)â”‚
              â”‚  - HTTPS        â”‚
              â”‚  - è´Ÿè½½å‡è¡¡      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                      â”‚
    â–¼                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Gunicorn â”‚                          â”‚Gunicorn â”‚
â”‚Worker 1 â”‚                          â”‚Worker 2 â”‚
â”‚         â”‚                          â”‚         â”‚
â”‚FastAPI  â”‚                          â”‚FastAPI  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚                                      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ æ–‡ä»¶ç³»ç»Ÿ (NFS)  â”‚
              â”‚  Excel ä¸´æ—¶å­˜å‚¨ â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å®‰å…¨æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å®‰å…¨å±‚ (Security Layer)          â”‚
â”‚                                              â”‚
â”‚  1. HTTPS/TLS åŠ å¯†                           â”‚
â”‚     â””â”€ ä¼ è¾“å±‚åŠ å¯†                            â”‚
â”‚                                              â”‚
â”‚  2. CORS è·¨åŸŸæ§åˆ¶                            â”‚
â”‚     â””â”€ é™åˆ¶å…è®¸çš„åŸŸå                        â”‚
â”‚                                              â”‚
â”‚  3. æ–‡ä»¶éªŒè¯                                 â”‚
â”‚     â”œâ”€ æ–‡ä»¶ç±»å‹æ£€æŸ¥ (.xlsx only)            â”‚
â”‚     â””â”€ æ–‡ä»¶å¤§å°é™åˆ¶ (50MB)                  â”‚
â”‚                                              â”‚
â”‚  4. ä¸´æ—¶æ–‡ä»¶ç®¡ç†                             â”‚
â”‚     â”œâ”€ è‡ªåŠ¨ç”Ÿæˆä¸´æ—¶æ–‡ä»¶                      â”‚
â”‚     â””â”€ å¤„ç†å®Œæˆåè‡ªåŠ¨åˆ é™¤                    â”‚
â”‚                                              â”‚
â”‚  5. å¼‚å¸¸å¤„ç†                                 â”‚
â”‚     â”œâ”€ æ•è·æ‰€æœ‰å¼‚å¸¸                          â”‚
â”‚     â””â”€ è¿”å›å‹å¥½é”™è¯¯ä¿¡æ¯                      â”‚
â”‚                                              â”‚
â”‚  6. è¾“å…¥éªŒè¯                                 â”‚
â”‚     â””â”€ Pydantic æ•°æ®éªŒè¯                    â”‚
â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ€§èƒ½ä¼˜åŒ–æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            æ€§èƒ½ä¼˜åŒ–å±‚ (Performance Layer)      â”‚
â”‚                                              â”‚
â”‚  1. æ•°æ®å¤„ç†ä¼˜åŒ–                             â”‚
â”‚     â”œâ”€ Pandas å‘é‡åŒ–æ“ä½œ                    â”‚
â”‚     â””â”€ é¿å…å¾ªç¯ï¼Œä½¿ç”¨å†…ç½®å‡½æ•°                â”‚
â”‚                                              â”‚
â”‚  2. å†…å­˜ç®¡ç†                                 â”‚
â”‚     â”œâ”€ ä½¿ç”¨ BytesIO å†…å­˜æµ                  â”‚
â”‚     â””â”€ åŠæ—¶é‡Šæ”¾å¤§å¯¹è±¡                        â”‚
â”‚                                              â”‚
â”‚  3. å¹¶å‘å¤„ç†                                 â”‚
â”‚     â””â”€ Uvicorn å¼‚æ­¥ ASGI æœåŠ¡å™¨             â”‚
â”‚                                              â”‚
â”‚  4. ç¼“å­˜ç­–ç•¥ï¼ˆå¯æ‰©å±•ï¼‰                       â”‚
â”‚     â””â”€ LRU ç¼“å­˜åˆ†æç»“æœ                     â”‚
â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç›‘æ§æ¶æ„ï¼ˆå¯æ‰©å±•ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ç›‘æ§å±‚ (Monitoring Layer - å¯é€‰)     â”‚
â”‚                                              â”‚
â”‚  1. æ—¥å¿—è®°å½•                                 â”‚
â”‚     â”œâ”€ è®¿é—®æ—¥å¿—                              â”‚
â”‚     â”œâ”€ é”™è¯¯æ—¥å¿—                              â”‚
â”‚     â””â”€ æ€§èƒ½æ—¥å¿—                              â”‚
â”‚                                              â”‚
â”‚  2. æ€§èƒ½æŒ‡æ ‡                                 â”‚
â”‚     â”œâ”€ è¯·æ±‚å“åº”æ—¶é—´                          â”‚
â”‚     â”œâ”€ æ–‡ä»¶å¤„ç†æ—¶é—´                          â”‚
â”‚     â””â”€ å†…å­˜ä½¿ç”¨æƒ…å†µ                          â”‚
â”‚                                              â”‚
â”‚  3. å¥åº·æ£€æŸ¥                                 â”‚
â”‚     â””â”€ /health ç«¯ç‚¹                         â”‚
â”‚                                              â”‚
â”‚  4. å‘Šè­¦ç³»ç»Ÿï¼ˆå¯é€‰ï¼‰                         â”‚
â”‚     â””â”€ å¼‚å¸¸é˜ˆå€¼å‘Šè­¦                          â”‚
â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**æ¶æ„è¯´æ˜å®Œæˆï¼** ğŸ›ï¸

è¿™ä¸ªæ¶æ„è®¾è®¡ç¡®ä¿äº†ï¼š
- âœ… æ¨¡å—åŒ–å’Œå¯ç»´æŠ¤æ€§
- âœ… æ¸…æ™°çš„èŒè´£åˆ†ç¦»
- âœ… è‰¯å¥½çš„å¯æ‰©å±•æ€§
- âœ… ç”Ÿäº§ç¯å¢ƒå°±ç»ª


