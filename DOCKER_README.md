# ğŸ³ CorpPilot Docker éƒ¨ç½²æŒ‡å—

> **å¿«é€Ÿéƒ¨ç½²ä¼ä¸šçº§è¡Œæ”¿ä¸å·®æ—…æˆæœ¬æ•ˆèƒ½åˆ†æå¹³å°**

## ğŸ“¦ å·²å®Œæˆçš„é…ç½®

âœ… **å®Œæ•´çš„ Docker é…ç½®**
- Docker Compose ç¼–æ’æ–‡ä»¶
- Backend Dockerfile (Python FastAPI)
- Frontend Dockerfile (React + Vite + Nginx)
- Nginx åå‘ä»£ç†é…ç½®

âœ… **è‡ªåŠ¨åŒ–è„šæœ¬**
- `deploy.sh` - ä¸€é”®éƒ¨ç½²
- `restart-dev.sh` - å¿«é€Ÿé‡å¯
- `stop.sh` - åœæ­¢æœåŠ¡

âœ… **ä¼˜åŒ–é…ç½®**
- å¤šé˜¶æ®µæ„å»ºï¼ˆå‰ç«¯é•œåƒä¼˜åŒ– 90%+ï¼‰
- Volume æŒ‚è½½ï¼ˆåç«¯çƒ­é‡è½½ï¼‰
- å¥åº·æ£€æŸ¥
- .dockerignore ä¼˜åŒ–

âœ… **å®Œæ•´æ–‡æ¡£**
- å¿«é€Ÿå¯åŠ¨æŒ‡å—
- è¯¦ç»†éƒ¨ç½²æ–‡æ¡£
- æ•…éšœæ’æŸ¥æ‰‹å†Œ

---

## ğŸš€ ä¸‰æ­¥å¿«é€Ÿéƒ¨ç½²

### å‰ç½®è¦æ±‚
- Docker 20.10+
- Docker Compose 2.0+

### éƒ¨ç½²æ­¥éª¤

```bash
# Step 1: èµ‹äºˆæ‰§è¡Œæƒé™
chmod +x deploy.sh restart-dev.sh stop.sh

# Step 2: ä¸€é”®éƒ¨ç½²
./deploy.sh

# Step 3: è®¿é—®åº”ç”¨
# å‰ç«¯: http://localhost:8180
# åç«¯: http://localhost:8000
# æ–‡æ¡£: http://localhost:8180/docs
```

---

## ğŸ“– æ–‡æ¡£ç´¢å¼•

| æ–‡æ¡£ | è¯´æ˜ | é€‚ç”¨äººç¾¤ |
|------|------|----------|
| [DOCKER_QUICK_START.md](DOCKER_QUICK_START.md) | âš¡ å¿«é€Ÿå¯åŠ¨æŒ‡å— | æ‰€æœ‰ç”¨æˆ· |
| [DOCKER_DEPLOYMENT.md](DOCKER_DEPLOYMENT.md) | ğŸ“– å®Œæ•´éƒ¨ç½²æ–‡æ¡£ | è¿ç»´äººå‘˜ |
| [DOCKER_FILES_SUMMARY.md](DOCKER_FILES_SUMMARY.md) | ğŸ“‹ æ–‡ä»¶æ¸…å•æ±‡æ€» | å¼€å‘äººå‘˜ |

---

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### å¼€å‘æ¨¡å¼
- âœ… åç«¯ä»£ç ä¿®æ”¹åè‡ªåŠ¨é‡è½½ï¼ˆuvicorn --reloadï¼‰
- âœ… å‰ç«¯ä»£ç å¿«é€Ÿé‡æ–°æ„å»ºï¼ˆåˆ©ç”¨ Docker ç¼“å­˜ï¼‰
- âœ… æ™ºèƒ½æ£€æµ‹ä¾èµ–æ–‡ä»¶å˜æ›´

### ç”Ÿäº§å°±ç»ª
- âœ… Nginx åå‘ä»£ç†è§£å†³è·¨åŸŸé—®é¢˜
- âœ… React Router History æ¨¡å¼æ”¯æŒ
- âœ… é™æ€èµ„æºç¼“å­˜ä¼˜åŒ–
- âœ… Gzip å‹ç¼©
- âœ… å¥åº·æ£€æŸ¥

### æ¶æ„è®¾è®¡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ç”¨æˆ·æµè§ˆå™¨ (Browser)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ http://localhost:8180
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend Container (Port 8180 â†’ 80)     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Nginx                             â”‚  â”‚
â”‚  â”‚  â”œâ”€ / â†’ React App (SPA)           â”‚  â”‚
â”‚  â”‚  â””â”€ /api â†’ proxy_pass backend     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ Internal Docker Network
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend Container (Port 8000)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  FastAPI + Uvicorn                 â”‚  â”‚
â”‚  â”‚  - /api/upload                     â”‚  â”‚
â”‚  â”‚  - /api/analysis                   â”‚  â”‚
â”‚  â”‚  - /docs (Swagger)                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ å¼€å‘å·¥ä½œæµ

### åœºæ™¯ 1: ä¿®æ”¹åç«¯ä»£ç 
```bash
# 1. ç¼–è¾‘ Python æ–‡ä»¶
vim backend/app/api/routes.py

# 2. ä¿å­˜åè‡ªåŠ¨ç”Ÿæ•ˆï¼ˆçƒ­é‡è½½ï¼‰
# 3. åˆ·æ–°æµè§ˆå™¨æµ‹è¯•
```

### åœºæ™¯ 2: ä¿®æ”¹å‰ç«¯ä»£ç 
```bash
# 1. ç¼–è¾‘ React æ–‡ä»¶
vim frontend/src/App.tsx

# 2. å¿«é€Ÿé‡å¯
./restart-dev.sh

# 3. ç­‰å¾… 10-30 ç§’ï¼Œåˆ·æ–°æµè§ˆå™¨
```

### åœºæ™¯ 3: æ–°å¢ä¾èµ–
```bash
# 1. ä¿®æ”¹ä¾èµ–æ–‡ä»¶
echo "requests==2.31.0" >> backend/requirements.txt

# 2. å®Œæ•´é‡æ–°éƒ¨ç½²
./deploy.sh
```

---

## ğŸ“Š å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

| æ“ä½œ | å‘½ä»¤ |
|------|------|
| ğŸš€ éƒ¨ç½² | `./deploy.sh` |
| ğŸ”„ é‡å¯ | `./restart-dev.sh` |
| ğŸ›‘ åœæ­¢ | `./stop.sh` |
| ğŸ“œ æŸ¥çœ‹æ—¥å¿— | `docker-compose logs -f` |
| ğŸ“Š æŸ¥çœ‹çŠ¶æ€ | `docker-compose ps` |
| ğŸ”§ è¿›å…¥åç«¯å®¹å™¨ | `docker exec -it corppilot-backend bash` |
| ğŸ¨ è¿›å…¥å‰ç«¯å®¹å™¨ | `docker exec -it corppilot-frontend sh` |

---

## ğŸ› å¿«é€Ÿæ•…éšœæ’æŸ¥

### é—®é¢˜ 1: æ— æ³•è®¿é—®å‰ç«¯
```bash
# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹å‰ç«¯æ—¥å¿—
docker-compose logs frontend

# é‡å¯å‰ç«¯
docker-compose restart frontend
```

### é—®é¢˜ 2: API è¯·æ±‚å¤±è´¥
```bash
# æ£€æŸ¥åç«¯çŠ¶æ€
docker-compose ps backend

# æŸ¥çœ‹åç«¯æ—¥å¿—
docker-compose logs backend

# æµ‹è¯•åç«¯è¿æ¥
curl http://localhost:8000/
```

### é—®é¢˜ 3: ç«¯å£è¢«å ç”¨
```bash
# æŸ¥æ‰¾å ç”¨è¿›ç¨‹
lsof -i :8180

# æ€æ­»è¿›ç¨‹
kill -9 <PID>

# æˆ–ä¿®æ”¹ç«¯å£
# ç¼–è¾‘ docker-compose.yml ä¸­çš„ ports
```

æ›´å¤šé—®é¢˜è¯·æŸ¥çœ‹ [DOCKER_DEPLOYMENT.md](DOCKER_DEPLOYMENT.md) çš„æ•…éšœæ’æŸ¥ç« èŠ‚ã€‚

---

## ğŸ” ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### å¿«é€Ÿåˆ‡æ¢åˆ°ç”Ÿäº§æ¨¡å¼

1. **ç¼–è¾‘ `backend/Dockerfile`**:
```dockerfile
# ç§»é™¤ --reload å‚æ•°
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
```

2. **ç¼–è¾‘ `docker-compose.yml`**:
```yaml
backend:
  # æ³¨é‡Šæ‰å¼€å‘æ¨¡å¼çš„ volume æŒ‚è½½
  # volumes:
  #   - ./backend:/app
  environment:
    - DEBUG=False
```

3. **é…ç½®ç¯å¢ƒå˜é‡**:
```bash
cp env.example .env
vim .env  # ä¿®æ”¹ç”Ÿäº§é…ç½®
```

4. **é‡æ–°éƒ¨ç½²**:
```bash
./stop.sh
./deploy.sh
```

---

## ğŸ“š æŠ€æœ¯æ ˆ

### Backend
- Python 3.9
- FastAPI 0.109.0
- Uvicorn
- Pandas, Openpyxl

### Frontend
- React 18
- TypeScript
- Vite
- Ant Design
- ECharts

### Infrastructure
- Docker & Docker Compose
- Nginx (Alpine)
- Linux

---

## ğŸ“ é…ç½®æ–‡ä»¶è¯´æ˜

### æ ¸å¿ƒæ–‡ä»¶
- `docker-compose.yml` - æœåŠ¡ç¼–æ’
- `backend/Dockerfile` - åç«¯é•œåƒ
- `frontend/Dockerfile` - å‰ç«¯é•œåƒï¼ˆå¤šé˜¶æ®µæ„å»ºï¼‰
- `frontend/nginx.conf` - Nginx é…ç½®

### è„šæœ¬æ–‡ä»¶
- `deploy.sh` - ä¸€é”®éƒ¨ç½²
- `restart-dev.sh` - å¿«é€Ÿé‡å¯
- `stop.sh` - åœæ­¢æœåŠ¡

### é…ç½®æ–‡ä»¶
- `env.example` - ç¯å¢ƒå˜é‡æ¨¡æ¿
- `backend/.dockerignore` - åç«¯æ„å»ºæ’é™¤
- `frontend/.dockerignore` - å‰ç«¯æ„å»ºæ’é™¤

---

## ğŸ’¡ æœ€ä½³å®è·µ

### âœ… DO (æ¨è)
- âœ… ä½¿ç”¨ `restart-dev.sh` å¿«é€Ÿè¿­ä»£
- âœ… å®šæœŸè¿è¡Œ `docker system prune` æ¸…ç†èµ„æº
- âœ… æäº¤ä»£ç å‰è¿è¡Œå®Œæ•´çš„ `deploy.sh` æµ‹è¯•
- âœ… ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†é…ç½®
- âœ… æŸ¥çœ‹æ—¥å¿—å®šä½é—®é¢˜

### âŒ DON'T (é¿å…)
- âŒ ä¸è¦ç›´æ¥ä¿®æ”¹å®¹å™¨å†…çš„æ–‡ä»¶
- âŒ ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ `--reload`
- âŒ ä¸è¦æäº¤ `.env` åˆ° Git
- âŒ ä¸è¦å¿½ç•¥å¥åº·æ£€æŸ¥å¤±è´¥
- âŒ ä¸è¦åœ¨æ²¡æœ‰æµ‹è¯•çš„æƒ…å†µä¸‹éƒ¨ç½²åˆ°ç”Ÿäº§

---

## ğŸ¯ æ€§èƒ½æŒ‡æ ‡

### é•œåƒå¤§å°
- Backend: ~500MB (Python + ä¾èµ–)
- Frontend: ~40MB (Nginx + é™æ€æ–‡ä»¶)

### å¯åŠ¨æ—¶é—´
- é¦–æ¬¡æ„å»º: 3-5 åˆ†é’Ÿ
- é‡å¯ï¼ˆæœ‰ç¼“å­˜ï¼‰: 10-30 ç§’
- åç«¯çƒ­é‡è½½: < 2 ç§’

### èµ„æºå ç”¨
- Backend: ~200MB RAM
- Frontend: ~10MB RAM

---

## ğŸ“ æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼š

1. ğŸ“– æŸ¥çœ‹ [DOCKER_QUICK_START.md](DOCKER_QUICK_START.md)
2. ğŸ“š é˜…è¯» [DOCKER_DEPLOYMENT.md](DOCKER_DEPLOYMENT.md)
3. ğŸ› æŸ¥çœ‹æ—¥å¿—: `docker-compose logs -f`
4. ğŸ’¬ è”ç³»å¼€å‘å›¢é˜Ÿ

---

## ğŸ‰ éƒ¨ç½²æˆåŠŸç¤ºä¾‹

```bash
$ ./deploy.sh

==========================================
  CorpPilot Docker ä¸€é”®éƒ¨ç½²è„šæœ¬
==========================================

âœ… Docker ç¯å¢ƒæ£€æŸ¥é€šè¿‡
ğŸ§¹ æ¸…ç†æ—§å®¹å™¨...
ğŸ”¨ å¼€å§‹æ„å»º Docker é•œåƒ...
âœ… é•œåƒæ„å»ºå®Œæˆ
ğŸš€ å¯åŠ¨æœåŠ¡...
âœ… æœåŠ¡å¯åŠ¨æˆåŠŸï¼

ğŸ“Š æœåŠ¡çŠ¶æ€ï¼š
NAME                  STATUS    PORTS
corppilot-backend     Up        0.0.0.0:8000->8000/tcp
corppilot-frontend    Up        0.0.0.0:8180->80/tcp

==========================================
  ğŸ‰ éƒ¨ç½²å®Œæˆï¼
==========================================

ğŸ“ è®¿é—®åœ°å€ï¼š
   å‰ç«¯ç•Œé¢ï¼š http://localhost:8180
   åç«¯ APIï¼š http://localhost:8000
   API æ–‡æ¡£ï¼š http://localhost:8180/docs
```

---

**é¡¹ç›®**: CorpPilot - ä¼ä¸šçº§è¡Œæ”¿ä¸å·®æ—…æˆæœ¬æ•ˆèƒ½åˆ†æå¹³å°  
**ç‰ˆæœ¬**: 1.0.0  
**æ›´æ–°æ—¶é—´**: 2026å¹´1æœˆ5æ—¥

**ğŸš€ ç°åœ¨å¼€å§‹ä½¿ç”¨ Docker éƒ¨ç½²æ‚¨çš„åº”ç”¨å§ï¼**

